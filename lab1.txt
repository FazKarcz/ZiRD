CREATE TABLE REGIONS(
	region_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	region_name VARCHAR(35)
	);

CREATE TABLE COUNTRIES(
	country_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	country_name VARCHAR(35) NOT NULL,
	region_id INT NOT NULL,
	CONSTRAINT fk_regions FOREIGN KEY(region_id) REFERENCES REGIONS(region_id)
	);

CREATE TABLE LOCATIONS(
	location_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	street_address VARCHAR(35),
	postal_code VARCHAR(10),
	city VARCHAR(30),
	state_province VARCHAR(30),
	country_id INT,
	CONSTRAINT fk_countries FOREIGN KEY(country_id) REFERENCES COUNTRIES(country_id)
	);

CREATE TABLE EMPLOYEES(
	employee_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	first_name VARCHAR(30) NOT NULL,
	last_name VARCHAR(30) NOT NULL,
	email VARCHAR(35) NOT NULL,
	phone_number VARCHAR(20) NOT NULL,
	hire_date DATE NOT NULL,
	job_id INT,
	salary DECIMAL(10, 2) NOT NULL,
	commission_pct NUMBER NOT NULL,
	manager_id INT NOT NULL,
	department_id INT NOT NULL
);

CREATE TABLE DEPARTMENTS(
	department_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	department_name VARCHAR(35) NOT NULL,
	manager_id INT NOT NULL,
	location_id INT NOT NULL,
	CONSTRAINT fk_employees FOREIGN KEY(manager_id) REFERENCES EMPLOYEES(employee_id),
	CONSTRAINT fk_locations FOREIGN KEY(location_id) REFERENCES LOCATIONS(location_id)
	);

CREATE TABLE JOBS(
	job_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	job_title VARCHAR(35) NOT NULL,
	min_salary DECIMAL(10, 2) NOT NULL,
	max_salary DECIMAL(10, 2) NOT NULL,
	CHECK (max_salary - min_salary > 2000)
	);

CREATE TABLE JOB_HISTORY(
	employee_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	start_date DATE NOT NULL,
	end_date DATE NOT NULL,
	job_id INT NOT NULL,
	department_id NUMBER NOT NULL,
	CONSTRAINT fk_jobs, FOREIGN KEY(job_id) REFERENCES JOBS(job_id),
	CONSTRAINT fk_departments, FOREIGN KEY(department_id) REFERENCES DEPARTMENTS(department_id)
	);

ALTER TABLE EMPLOYEES 
ADD CONSTRAINT fk_department
FOREIGN KEY(department_id) REFERENCES DEPARTMENTS(department_id);

ALTER TABLE EMPLOYEES 
ADD CONSTRAINT fk_manager
FOREIGN KEY(manager_id) REFERENCES EMPLOYEES(employee_id);